FROM registry.access.redhat.com/ubi9/python-311:latest
ENV PYTHONDONTWRITEBYTECODE=1 \
    PYTHONUNBUFFERED=1
WORKDIR /app
COPY pyproject.toml README.md* ./
RUN pip install --no-cache-dir --upgrade pip setuptools wheel && \
    pip install --no-cache-dir .
COPY crew_ai_crew.py ./
RUN chgrp -R 0 /app && chmod -R g+rwX /app
USER 1001
CMD ["agents-crew"]